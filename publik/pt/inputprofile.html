<!DOCTYPE html>
<html>
<head>
    <title>Quick Fix - Test Localhost</title>
</head>
<body>
    <h2>Testing Connection</h2>
    <button onclick="testConnection()">Test Now</button>
    <div id="result"></div>

    <script>
        const SHEET_ID = '1XCTZBBxu4HGDZ1e7JW8DJGdoYT8tMkooxfNrZMJoruY';
        const API_KEY = 'AIzaSyBR1XK5osDoe2Mvsk1TCUt0ebrMqQu1Gv4';
        
        async function testConnection() {
            document.getElementById('result').innerHTML = '<p>Testing...</p>';
            
            try {
                // Test 1: Basic access
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}?key=${API_KEY}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('result').innerHTML = 
                        `<p style="color:green">✓ SUCCESS! Connected to: ${data.properties.title}</p>
                         <p>Now testing from: ${window.location.origin}</p>
                         <p><strong>If you see this, API Key works!</strong></p>`;
                } else {
                    document.getElementById('result').innerHTML = 
                        `<p style="color:red">✗ ERROR: ${data.error.message}</p>
                         <p>Testing from: ${window.location.origin || 'file://'}</p>
                         <p><strong>Problem: API Key blocked for this domain</strong></p>
                         <p>Add this to API Key restrictions: <code>${window.location.origin}/*</code></p>`;
                }
            } catch (error) {
                document.getElementById('result').innerHTML = 
                    `<p style="color:red">✗ NETWORK ERROR: ${error.message}</p>`;
            }
        }
        
        // Auto test
        testConnection();
    </script>
</body>
</html>
