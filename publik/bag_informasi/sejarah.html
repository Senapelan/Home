<!DOCTYPE html>
<html lang="id">
<head>
    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://senapelan.github.io/Home/kelurahanpadangterubuk.html">
    <meta property="og:title" content="Sejarah Kelurahan Padang Terubuk - Arsip Digital">
    <meta property="og:description" content="Jelajahi sejarah Kelurahan Padang Terubuk dalam arsip digital modern">
    <meta property="og:site_name" content="Padang Terubuk">
    <meta property="og:image" content="https://senapelan.github.io/Home/data/foto/thumbnailpadangterubuk.png">
    <meta property="og:image:secure_url" content="https://senapelan.github.io/Home/data/foto/thumbnail.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="1200">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Sejarah Kelurahan Padang Terubuk - Arsip Digital">
    <meta name="twitter:description" content="Jelajahi sejarah Kelurahan Padang Terubuk dalam arsip digital modern">
    <meta name="twitter:image" content="https://senapelan.github.io/Home/data/foto/thumbnailpadangterubuk.png">
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Sejarah Kelurahan Padang Terubuk - Arsip Digital</title>
    
    <!-- GOOGLE FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- FAVICON -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://senapelan.github.io/Home/data/foto/favico/favico.png">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- 3D LIBRARY -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        :root {
            --primary: #1e6bff;
            --primary-dark: #0a4fcc;
            --secondary: #00c9b7;
            --accent: #ff6b6b;
            --dark: #0c1f33;
            --light: #f6f7f9;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text: #2c3e50;
            --text-light: #5d6d7e;
            --shadow-lg: 0 25px 50px rgba(0, 0, 0, 0.15);
            --shadow-sm: 0 8px 30px rgba(0, 0, 0, 0.12);
            --transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Old Paper Colors */
            --parchment: #f5e9d8;
            --parchment-dark: #e8d5b5;
            --parchment-light: #faf0e0;
            --ink-old: #3e2c1a;
            --sepia: #8b5a2b;
            --gold-old: #b48643;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100vh;
            overflow: hidden;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #66757f, #4a5a63);
            color: var(--text);
            position: relative;
        }

        /* Wood Texture Background */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><filter id="wood"><feTurbulence type="fractalNoise" baseFrequency="0.4" numOctaves="2" stitchTiles="stitch"/><feColorMatrix type="matrix" values="1 0 0 0 0.3 0 1 0 0 0.2 0 0 1 0 0.1 0 0 0 1 0"/></filter><rect width="100" height="100" filter="url(%23wood)" opacity="0.1"/></svg>');
            pointer-events: none;
            z-index: -1;
        }

        /* 3D Background */
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }

        /* Glass Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            background: rgba(12, 31, 51, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            z-index: 1000;
            transition: var(--transition);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            text-decoration: none;
        }

        .logo-img {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            overflow: hidden;
            background: transparent;
        }

        .logo-img img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-main {
            font-family: 'Poppins', sans-serif;
            font-size: 20px;
            font-weight: 800;
            background: linear-gradient(135deg, #fff, #a3d4ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-sub {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
        }

        /* Back Button - Modern */
        .back-button {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 28px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            border-radius: 50px;
            color: white;
            text-decoration: none;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 16px;
            transition: var(--transition);
            box-shadow: 0 10px 20px rgba(30, 107, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .back-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .back-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(30, 107, 255, 0.4);
        }

        .back-button:hover::before {
            left: 100%;
        }

        /* Main Container - Full Screen */
        .main-container {
            height: 100vh;
            width: 100%;
            padding: 100px 40px 40px;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 10;
        }

        /* Title Bar */
        .title-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .title-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .title-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            box-shadow: 0 10px 20px rgba(30, 107, 255, 0.3);
        }

        .title-text h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 32px;
            font-weight: 800;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 5px;
        }

        .title-text p {
            color: rgba(255,255,255,0.9);
            font-size: 16px;
        }

        /* Page Indicator */
        .page-indicator {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 12px 30px;
            border-radius: 50px;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .page-indicator span {
            color: var(--secondary);
            font-size: 18px;
            margin: 0 5px;
        }

        /* Content Grid */
        .content-grid {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            min-height: 0;
            padding: 0 20px;
        }

        /* Old Paper Card Style */
        .history-card {
            background: var(--parchment);
            background-image: 
                linear-gradient(145deg, rgba(255,255,240,0.8) 0%, rgba(230,210,170,0.9) 100%),
                repeating-linear-gradient(45deg, rgba(180,130,70,0.02) 0px, rgba(180,130,70,0.02) 2px, transparent 2px, transparent 6px);
            border-radius: 24px;
            padding: 40px;
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.3),
                inset 0 0 0 1px rgba(255,255,200,0.7),
                inset 0 0 20px rgba(140,90,40,0.2);
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--gold-old);
            transition: var(--transition);
        }

        /* Torn Paper Edges */
        .history-card::before {
            content: "";
            position: absolute;
            top: -5px;
            left: 0;
            right: 0;
            height: 10px;
            background: inherit;
            filter: blur(2px);
            opacity: 0.3;
        }

        .history-card::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 0;
            right: 0;
            height: 10px;
            background: inherit;
            filter: blur(2px);
            opacity: 0.3;
        }

        /* Old Paper Texture */
        .history-card .paper-texture {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.65" numOctaves="1" stitchTiles="stitch"/><feColorMatrix type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.15 0"/></filter><rect width="200" height="200" filter="url(%23noise)" opacity="0.4"/></svg>');
            opacity: 0.15;
            pointer-events: none;
            border-radius: inherit;
        }

        /* Ink Stains */
        .history-card .ink-stain {
            position: absolute;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(100,60,20,0.1) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
        }

        .history-card .stain-1 {
            top: 20px;
            right: 20px;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(140,90,40,0.08) 0%, transparent 70%);
        }

        .history-card .stain-2 {
            bottom: 30px;
            left: 30px;
            width: 180px;
            height: 180px;
            background: radial-gradient(circle, rgba(100,70,30,0.06) 0%, transparent 70%);
        }

        .history-card .stain-3 {
            top: 50%;
            left: 20%;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(80,50,20,0.05) 0%, transparent 70%);
        }

        .history-card:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 25px 50px rgba(0,0,0,0.4),
                inset 0 0 0 1px rgba(255,215,140,0.8),
                inset 0 0 30px rgba(180,130,70,0.3);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(139, 69, 19, 0.2);
            position: relative;
            z-index: 2;
        }

        .page-badge {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #8b5a2b, #5d3a1a);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f5e9d8;
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 20px;
            box-shadow: 0 5px 15px rgba(100,50,10,0.3);
            border: 2px solid #b48643;
            position: relative;
            overflow: hidden;
        }

        .page-badge::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, transparent, rgba(255,255,200,0.2));
        }

        .card-header h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 28px;
            font-weight: 700;
            color: #3e2c1a;
            flex: 1;
            letter-spacing: 1px;
        }

        .card-content {
            flex: 1;
            overflow-y: auto;
            padding-right: 10px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 18px;
            line-height: 1.8;
            color: #2c1e0f;
            position: relative;
            z-index: 2;
        }

        .card-content p {
            margin-bottom: 20px;
            text-align: justify;
        }

        .card-content p:first-of-type::first-letter {
            font-family: 'Cormorant Garamond', serif;
            font-size: 60px;
            font-weight: 700;
            float: left;
            line-height: 0.8;
            margin-right: 15px;
            color: #8b5a2b;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        /* Custom Scrollbar - Vintage Style */
        .card-content::-webkit-scrollbar {
            width: 10px;
        }

        .card-content::-webkit-scrollbar-track {
            background: #d9c2a7;
            border-radius: 10px;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.1);
        }

        .card-content::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #8b5a2b, #5d3a1a);
            border-radius: 10px;
            border: 2px solid #b48643;
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #8b5a2b;
            text-align: center;
            padding: 40px;
            font-family: 'Cormorant Garamond', serif;
        }

        .empty-state i {
            font-size: 80px;
            color: rgba(139, 69, 19, 0.2);
            margin-bottom: 20px;
        }

        .empty-state p {
            font-size: 20px;
            font-style: italic;
        }

        /* Navigation Controls */
        .nav-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            padding: 0 20px;
        }

        .nav-btn {
            width: 60px;
            height: 60px;
            border-radius: 30px;
            background: white;
            border: 2px solid rgba(30, 107, 255, 0.1);
            color: var(--primary);
            font-size: 24px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-sm);
        }

        .nav-btn:not(:disabled):hover {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            border-color: transparent;
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .page-info {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 12px 40px;
            border-radius: 40px;
            color: white;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .page-info i {
            margin-right: 10px;
            color: var(--secondary);
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 30, 15, 0.95);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: opacity 0.5s ease;
        }

        .loading-spinner {
            width: 100px;
            height: 100px;
            border: 6px solid #8b5a2b;
            border-top: 6px solid #b48643;
            border-right: 6px solid #f5e9d8;
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            margin-bottom: 30px;
            box-shadow: 0 0 30px rgba(180, 134, 67, 0.3);
        }

        .loading-text {
            font-family: 'Cormorant Garamond', serif;
            font-size: 28px;
            font-weight: 600;
            color: #f5e9d8;
            letter-spacing: 2px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Reading Progress - Vintage Style */
        .reading-progress {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 120px;
            height: 120px;
            z-index: 100;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));
        }

        .progress-circle {
            transform: rotate(-90deg);
        }

        .progress-bg, .progress-bar {
            fill: none;
            stroke-width: 4;
        }

        .progress-bg {
            stroke: rgba(180, 134, 67, 0.2);
        }

        .progress-bar {
            stroke: url(#gradient);
            stroke-linecap: round;
            transition: stroke-dashoffset 0.3s ease;
            filter: drop-shadow(0 0 5px #b48643);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .content-grid {
                gap: 20px;
            }
            
            .history-card {
                padding: 30px;
            }
        }

        @media (max-width: 992px) {
            .main-container {
                padding: 90px 20px 20px;
            }
            
            .title-text h1 {
                font-size: 28px;
            }
            
            .card-header h2 {
                font-size: 24px;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 0 20px;
            }
            
            .logo-main {
                font-size: 16px;
            }
            
            .logo-sub {
                display: none;
            }
            
            .back-button span {
                display: none;
            }
            
            .back-button {
                padding: 12px 18px;
            }
            
            .content-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .title-bar {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .page-indicator {
                align-self: flex-end;
            }
            
            .nav-controls {
                flex-wrap: wrap;
            }
            
            .reading-progress {
                bottom: 15px;
                right: 15px;
                width: 80px;
                height: 80px;
            }
        }

        @media (max-width: 480px) {
            .title-section {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .history-card {
                padding: 25px 20px;
            }
            
            .page-info {
                padding: 12px 20px;
                font-size: 14px;
            }
            
            .nav-btn {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
            
            .card-content {
                font-size: 16px;
            }
            
            .card-header h2 {
                font-size: 22px;
            }
        }

        /* Gradient Definition */
        .progress-svg {
            position: absolute;
            width: 0;
            height: 0;
        }
    </style>
</head>
<body>
    <!-- 3D Background -->
    <canvas id="bg-canvas"></canvas>

    <!-- SVG Gradient -->
    <svg class="progress-svg">
        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="#8b5a2b" />
            <stop offset="100%" stop-color="#b48643" />
        </linearGradient>
    </svg>

    <!-- Modern Header -->
    <header class="header">
        <a href="https://senapelan.github.io/Home/kelurahanpadangterubuk.html" class="logo">
            <div class="logo-img">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/Logo_lambang_kota_pekanbaru.png/960px-Logo_lambang_kota_pekanbaru.png" alt="Logo">
            </div>
            <div class="logo-text">
                <div class="logo-main">Padang Terubuk</div>
                <div class="logo-sub">Arsip Digital</div>
            </div>
        </a>
        
        <a href="https://senapelan.github.io/Home/kelurahanpadangterubuk.html" class="back-button">
            <i class="fas fa-arrow-left"></i>
            <span>Kembali</span>
        </a>
    </header>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Title Bar -->
        <div class="title-bar">
            <div class="title-section">
                <div class="title-icon">
                    <i class="fas fa-scroll"></i>
                </div>
                <div class="title-text">
                    <h1 id="bookTitle">SEJARAH KELURAHAN</h1>
                    <p id="bookSubtitle">Padang Terubuk · Manuskrip Digital</p>
                </div>
            </div>
            <div class="page-indicator" id="pageIndicator">
                Folio <span id="currentPageDisplay">1</span> dari <span id="totalPagesDisplay">7</span>
            </div>
        </div>

        <!-- Content Grid -->
        <div class="content-grid" id="contentGrid">
            <!-- Left Card -->
            <div class="history-card" id="leftCard">
                <!-- Paper Textures -->
                <div class="paper-texture"></div>
                <div class="ink-stain stain-1"></div>
                <div class="ink-stain stain-2"></div>
                <div class="ink-stain stain-3"></div>
                
                <div class="card-header">
                    <div class="page-badge" id="leftBadge">1</div>
                    <h2 id="leftTitle">Bab 1</h2>
                </div>
                <div class="card-content" id="leftContent">
                    <p>Memuat manuskrip...</p>
                </div>
            </div>

            <!-- Right Card -->
            <div class="history-card" id="rightCard">
                <!-- Paper Textures -->
                <div class="paper-texture"></div>
                <div class="ink-stain stain-1"></div>
                <div class="ink-stain stain-2"></div>
                <div class="ink-stain stain-3"></div>
                
                <div class="card-header">
                    <div class="page-badge" id="rightBadge">2</div>
                    <h2 id="rightTitle">Bab 2</h2>
                </div>
                <div class="card-content" id="rightContent">
                    <p>Memuat manuskrip...</p>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-controls">
            <button class="nav-btn" id="prevBtn" disabled>
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <div class="page-info">
                <i class="fas fa-feather-alt"></i>
                <span id="pageRange">1-2</span>
            </div>
            
            <button class="nav-btn" id="nextBtn">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <!-- Reading Progress -->
    <div class="reading-progress">
        <svg viewBox="0 0 120 120" width="120" height="120">
            <circle class="progress-bg" cx="60" cy="60" r="54" />
            <circle class="progress-bar" cx="60" cy="60" r="54" 
                    stroke-dasharray="339.292" 
                    stroke-dashoffset="339.292" 
                    id="progressCircle" />
        </svg>
    </div>

    <!-- Loading -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Membuka manuskrip kuno...</div>
    </div>

    <script>
        // Google Sheets
        const SPREADSHEET_ID = '1NfodZgDQ8kyGGlWkJbcv57aJO2cY5a1KzPk23Gm4bFg';
        const SHEET_NAME = 'SEJARAH';
        
        // State
        let bookData = {
            title: 'SEJARAH KELURAHAN PADANG TERUBUK',
            pages: []
        };
        
        let currentPage = 0;
        let totalPages = 0;
        
        // DOM Elements
        const loadingOverlay = document.getElementById('loadingOverlay');
        const bookTitle = document.getElementById('bookTitle');
        const bookSubtitle = document.getElementById('bookSubtitle');
        const leftContent = document.getElementById('leftContent');
        const rightContent = document.getElementById('rightContent');
        const leftBadge = document.getElementById('leftBadge');
        const rightBadge = document.getElementById('rightBadge');
        const leftTitle = document.getElementById('leftTitle');
        const rightTitle = document.getElementById('rightTitle');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const currentPageDisplay = document.getElementById('currentPageDisplay');
        const totalPagesDisplay = document.getElementById('totalPagesDisplay');
        const pageRange = document.getElementById('pageRange');
        const progressCircle = document.getElementById('progressCircle');

        // Initialize 3D
        function init3DBackground() {
            const canvas = document.getElementById('bg-canvas');
            if (!canvas || typeof THREE === 'undefined') return;

            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
            
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

            // Floating particles - warm colors
            const particlesGeometry = new THREE.BufferGeometry();
            const particlesCount = 150;
            const posArray = new Float32Array(particlesCount * 3);
            const colorArray = new Float32Array(particlesCount * 3);
            
            for(let i = 0; i < particlesCount * 3; i += 3) {
                posArray[i] = (Math.random() - 0.5) * 15;
                posArray[i+1] = (Math.random() - 0.5) * 15;
                posArray[i+2] = (Math.random() - 0.5) * 15;
                
                // Warm colors
                colorArray[i] = 0.8; // R
                colorArray[i+1] = 0.6; // G
                colorArray[i+2] = 0.3; // B
            }
            
            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colorArray, 3));
            
            const particlesMaterial = new THREE.PointsMaterial({
                size: 0.03,
                vertexColors: true,
                transparent: true,
                opacity: 0.2,
                blending: THREE.AdditiveBlending
            });
            
            const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
            scene.add(particlesMesh);
            
            camera.position.z = 8;
            
            function animate() {
                requestAnimationFrame(animate);
                particlesMesh.rotation.y += 0.0003;
                particlesMesh.rotation.x += 0.0001;
                renderer.render(scene, camera);
            }
            
            animate();

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }

        // Fetch Data
        async function fetchSejarahData() {
            try {
                loadingOverlay.style.opacity = '1';
                loadingOverlay.style.display = 'flex';
                
                const csvUrl = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:csv&sheet=${SHEET_NAME}`;
                
                const response = await fetch(csvUrl);
                const csvText = await response.text();
                
                // Parse CSV
                const rows = csvText.split('\n').map(row => {
                    const matches = row.match(/(".*?"|[^,]+)(?=\s*,|\s*$)/g);
                    return matches ? matches.map(cell => cell.replace(/^"|"$/g, '').trim()) : [];
                });

                if (rows.length >= 2) {
                    bookData.title = rows[1][0] || 'SEJARAH KELURAHAN PADANG TERUBUK';
                    
                    const pages = rows[1].slice(1).filter(cell => cell && cell.trim() !== '');
                    
                    if (pages.length > 0) {
                        bookData.pages = pages;
                    } else {
                        bookData.pages = getFallbackData();
                    }
                } else {
                    bookData.pages = getFallbackData();
                }
                
                // Update UI
                bookTitle.textContent = bookData.title;
                bookSubtitle.textContent = `${bookData.pages.length} Halaman · Manuskrip Digital`;
                
                totalPages = bookData.pages.length;
                totalPagesDisplay.textContent = totalPages;
                
                renderPages();
                
                setTimeout(() => {
                    loadingOverlay.style.opacity = '0';
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                    }, 500);
                }, 800);
                
            } catch (error) {
                console.error('Error:', error);
                bookData.pages = getFallbackData();
                totalPages = bookData.pages.length;
                totalPagesDisplay.textContent = totalPages;
                renderPages();
                
                setTimeout(() => {
                    loadingOverlay.style.opacity = '0';
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                    }, 500);
                }, 800);
            }
        }

        function getFallbackData() {
            return [
                "Kelurahan Padang Terubuk berdiri pada tahun 1950-an, berawal dari sebuah perkampungan kecil di tepian Sungai Siak. Nama 'Padang Terubuk' diambil dari bahasa setempat yang berarti 'padang rumput yang luas', menggambarkan kondisi geografis wilayah yang dulunya merupakan hamparan savana dengan ilalang tinggi.",
                
                "Pada masa kolonial Belanda, wilayah ini merupakan daerah perkebunan dan tempat persinggahan para pedagang yang melewati Sungai Siak. Banyak pedagang dari Minangkabau, Melayu, dan Tionghoa yang singgah dan akhirnya menetap, membentuk masyarakat yang heterogen.",
                
                "Tahun 1960-an, Padang Terubuk mulai berkembang pesat seiring dengan dibukanya akses jalan darat yang menghubungkan wilayah ini dengan pusat Kota Pekanbaru. Pemukiman mulai tertata, fasilitas umum seperti sekolah dan pasar mulai dibangun.",
                
                "Memasuki tahun 1980-an, Padang Terubuk resmi menjadi kelurahan definitif di Kecamatan Senapelan. Pembangunan infrastruktur semakin gencar dilakukan, termasuk perbaikan jalan, drainase, dan penerangan umum.",
                
                "Era reformasi membawa perubahan signifikan dengan diterapkannya otonomi daerah. Kelurahan Padang Terubuk mulai mengembangkan berbagai program pemberdayaan masyarakat dan peningkatan kualitas pelayanan publik.",
                
                "Memasuki era digital, Padang Terubuk bertransformasi menjadi kelurahan modern dengan sistem pelayanan berbasis teknologi. Masyarakat dapat mengakses berbagai layanan administrasi secara online, mempermudah urusan kependudukan dan perizinan.",
                
                "Hingga kini, Kelurahan Padang Terubuk terus berbenah, mengedepankan prinsip transparansi, akuntabilitas, dan partisipasi masyarakat dalam setiap program pembangunan, dengan tetap memegang teguh nilai-nilai kearifan lokal."
            ];
        }

        function renderPages() {
            if (!bookData.pages.length) return;
            
            const leftIndex = currentPage;
            const rightIndex = currentPage + 1;
            
            // Left Page
            if (leftIndex < bookData.pages.length) {
                const leftText = bookData.pages[leftIndex];
                leftContent.innerHTML = formatContent(leftText);
                leftBadge.textContent = leftIndex + 1;
                leftTitle.textContent = `Bab ${leftIndex + 1}`;
            } else {
                leftContent.innerHTML = '<div class="empty-state"><i class="fas fa-feather-alt"></i><p>Halaman kosong</p></div>';
                leftBadge.textContent = '';
                leftTitle.textContent = 'Selesai';
            }
            
            // Right Page
            if (rightIndex < bookData.pages.length) {
                const rightText = bookData.pages[rightIndex];
                rightContent.innerHTML = formatContent(rightText);
                rightBadge.textContent = rightIndex + 1;
                rightTitle.textContent = `Bab ${rightIndex + 1}`;
            } else {
                rightContent.innerHTML = '<div class="empty-state"><i class="fas fa-scroll"></i><p>Tamat · Akhir dari manuskrip</p></div>';
                rightBadge.textContent = '';
                rightTitle.textContent = 'Tamat';
            }
            
            // Update UI
            currentPageDisplay.textContent = leftIndex + 1;
            pageRange.textContent = `${leftIndex + 1}-${Math.min(rightIndex + 1, totalPages)}`;
            
            // Update buttons
            prevBtn.disabled = currentPage <= 0;
            nextBtn.disabled = currentPage + 2 >= totalPages;
            
            // Update progress
            updateProgress();
        }

        function formatContent(text) {
            const paragraphs = text.split('\n').filter(p => p.trim() !== '');
            
            if (paragraphs.length === 0) {
                return `<p>${text}</p>`;
            }
            
            return paragraphs.map(p => `<p>${p}</p>`).join('');
        }

        function updateProgress() {
            const progress = ((currentPage + 1) / totalPages) * 100;
            const circumference = 2 * Math.PI * 54;
            const offset = circumference - (progress / 100) * circumference;
            progressCircle.style.strokeDashoffset = offset;
        }

        // Navigation
        prevBtn.addEventListener('click', () => {
            if (currentPage > 0) {
                currentPage -= 2;
                renderPages();
                leftContent.scrollTop = 0;
                rightContent.scrollTop = 0;
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentPage + 2 < totalPages) {
                currentPage += 2;
                renderPages();
                leftContent.scrollTop = 0;
                rightContent.scrollTop = 0;
            }
        });

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                prevBtn.click();
            } else if (e.key === 'ArrowRight') {
                nextBtn.click();
            }
        });

        // Touch Swipe
        let touchStartX = 0;
        
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        }, { passive: true });
        
        document.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].screenX;
            const diff = touchEndX - touchStartX;
            
            if (Math.abs(diff) > 50) {
                if (diff > 0) prevBtn.click();
                else nextBtn.click();
            }
        }, { passive: true });

        // Initialize
        if (typeof THREE !== 'undefined') {
            init3DBackground();
        }
        
        fetchSejarahData();

        // Add random ink spots (dynamic)
        function addRandomInkSpots() {
            const cards = document.querySelectorAll('.history-card');
            cards.forEach(card => {
                for (let i = 0; i < 3; i++) {
                    const spot = document.createElement('div');
                    spot.className = 'ink-stain';
                    spot.style.position = 'absolute';
                    spot.style.width = Math.random() * 100 + 50 + 'px';
                    spot.style.height = spot.style.width;
                    spot.style.left = Math.random() * 100 + '%';
                    spot.style.top = Math.random() * 100 + '%';
                    spot.style.background = `radial-gradient(circle, rgba(100,60,20,${0.03 + Math.random() * 0.05}) 0%, transparent 70%)`;
                    spot.style.pointerEvents = 'none';
                    spot.style.zIndex = '1';
                    card.appendChild(spot);
                }
            });
        }
        
        setTimeout(addRandomInkSpots, 1000);
    </script>
</body>
</html>
