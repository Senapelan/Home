<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Senapelan Satu Pintu</title>
    
    <!-- PWA META TAGS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Senapelan">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0A0F2B">
    
    <!-- ICONS -->
    <link rel="icon" href="data/foto/icon192.png" type="image/png">
    <link rel="apple-touch-icon" href="data/foto/icon192.png">
    
    <!-- MANIFEST -->
    <link rel="manifest" href="manifest.json">
    
    <style>
    /* RESET */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Segoe UI', system-ui, sans-serif;
    }
    
    body {
        color: white;
        background: #0A0F2B;
        min-height: 100vh;
        overflow-x: hidden;
    }
    
    /* INSTALL BANNER - VISIBLE BY DEFAULT FOR TESTING */
    .install-banner {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(10, 15, 43, 0.95);
        backdrop-filter: blur(20px);
        padding: 20px;
        border-radius: 20px;
        border: 2px solid #0066FF;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        z-index: 1000;
        width: 90%;
        max-width: 500px;
        display: flex;
        flex-direction: column;
        gap: 15px;
        animation: slideUp 0.5s ease-out;
    }
    
    @keyframes slideUp {
        from { transform: translate(-50%, 100%); opacity: 0; }
        to { transform: translate(-50%, 0); opacity: 1; }
    }
    
    .install-content {
        display: flex;
        align-items: center;
        gap: 15px;
    }
    
    .install-icon {
        width: 60px;
        height: 60px;
        border-radius: 12px;
        overflow: hidden;
        border: 2px solid #0066FF;
        background: white;
    }
    
    .install-icon img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        padding: 5px;
    }
    
    .install-text h3 {
        color: white;
        margin-bottom: 5px;
        font-size: 1.2rem;
    }
    
    .install-text p {
        color: #B3E0FF;
        font-size: 0.9rem;
    }
    
    .install-actions {
        display: flex;
        gap: 10px;
    }
    
    .install-btn {
        flex: 1;
        padding: 12px;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
    }
    
    .install-btn.primary {
        background: linear-gradient(135deg, #0066FF, #00D4AA);
        color: white;
    }
    
    .install-btn.secondary {
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .install-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 102, 255, 0.3);
    }
    
    .close-install {
        position: absolute;
        top: 10px;
        right: 10px;
        background: none;
        border: none;
        color: #B3E0FF;
        font-size: 1.2rem;
        cursor: pointer;
    }
    
    /* VIDEO BACKGROUND */
    .video-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -2;
    }
    
    .video-bg video {
        width: 100%;
        height: 100%;
        object-fit: cover;
        filter: brightness(0.6);
    }
    
    .overlay {
        position: fixed;
        inset: 0;
        background: linear-gradient(135deg, rgba(10, 15, 43, 0.9), rgba(0, 70, 204, 0.4));
        z-index: -1;
    }
    
    /* HEADER */
    header {
        text-align: center;
        padding: 60px 20px 40px;
    }
    
    header h1 {
        font-size: 2.5rem;
        background: linear-gradient(135deg, #0066FF, #00D4AA);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        margin-bottom: 20px;
        font-weight: 900;
    }
    
    header p {
        font-size: 1.2rem;
        color: #E6F2FF;
        max-width: 800px;
        margin: 0 auto;
        line-height: 1.6;
    }
    
    /* CONTAINER */
    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        padding-bottom: 100px;
    }
    
    /* CARD UTAMA */
    .card-utama {
        max-width: 800px;
        margin: 0 auto 50px;
    }
    
    .card-utama a {
        display: block;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 40px 30px;
        text-decoration: none;
        text-align: center;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s;
    }
    
    .card-utama a:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0, 102, 255, 0.2);
        border-color: #0066FF;
    }
    
    .card-utama img {
        max-height: 150px;
        margin-bottom: 20px;
    }
    
    .card-utama h3 {
        color: white;
        font-size: 1.8rem;
    }
    
    /* GRID */
    .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 30px;
    }
    
    /* CARD */
    .card a {
        display: block;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        text-decoration: none;
        text-align: center;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s;
        height: 100%;
    }
    
    .card a:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 102, 255, 0.2);
        border-color: #00D4AA;
    }
    
    .card img {
        max-height: 120px;
        margin-bottom: 15px;
    }
    
    .card h3 {
        color: white;
        font-size: 1.3rem;
        line-height: 1.4;
    }
    
    /* FOOTER */
    .footer {
        background: rgba(10, 15, 43, 0.95);
        padding: 40px 20px;
        text-align: center;
        border-top: 1px solid rgba(0, 102, 255, 0.2);
    }
    
    .footer-logo {
        width: 60px;
        margin-bottom: 20px;
    }
    
    .copyright {
        color: #B3E0FF;
        margin-bottom: 20px;
    }
    
    .footer-links {
        display: flex;
        justify-content: center;
        gap: 20px;
        flex-wrap: wrap;
        margin-bottom: 20px;
    }
    
    .footer-links a {
        color: #8CC8FF;
        text-decoration: none;
        transition: color 0.3s;
    }
    
    .footer-links a:hover {
        color: white;
    }
    
    .footer-note {
        color: rgba(179, 224, 255, 0.6);
        font-size: 0.9rem;
        max-width: 600px;
        margin: 0 auto;
    }
    
    /* RESPONSIVE */
    @media (max-width: 768px) {
        header h1 {
            font-size: 1.8rem;
        }
        
        header p {
            font-size: 1rem;
        }
        
        .install-banner {
            width: 95%;
            padding: 15px;
        }
        
        .install-actions {
            flex-direction: column;
        }
        
        .grid {
            grid-template-columns: 1fr;
        }
    }
    
    @media (max-width: 480px) {
        header {
            padding: 40px 15px 30px;
        }
        
        .card-utama a {
            padding: 25px 20px;
        }
        
        .card a {
            padding: 20px;
        }
    }
    </style>
</head>
<body>
    <!-- BACKGROUND -->
    <div class="video-bg">
        <video autoplay muted loop playsinline>
            <source src="data/video/home.mp4" type="video/mp4">
        </video>
    </div>
    <div class="overlay"></div>
    
    <!-- INSTALL BANNER - ALWAYS VISIBLE FOR TESTING -->
    <div class="install-banner" id="installBanner">
        <div class="install-content">
            <div class="install-icon">
                <img src="data/foto/icon512.png" alt="Senapelan">
            </div>
            <div class="install-text">
                <h3>Pasang Aplikasi Senapelan</h3>
                <p>Akses cepat tanpa browser â€¢ Bisa offline</p>
            </div>
        </div>
        <div class="install-actions">
            <button class="install-btn primary" id="installBtn">
                ðŸ“² Pasang Sekarang
            </button>
            <button class="install-btn secondary" id="laterBtn">
                Nanti Saja
            </button>
        </div>
        <button class="close-install" id="closeInstall">âœ•</button>
    </div>
    
    <!-- HEADER -->
    <header>
        <h1>SENAPELAN SATU PINTU</h1>
        <p>"Pelayanan cepat, transparan, dan modern berbasis digital"</p>
    </header>
    
    <!-- MAIN CONTENT -->
    <div class="container">
        <!-- CARD UTAMA -->
        <div class="card-utama">
            <a href="https://kec-senapelan.pekanbaru.go.id/" target="_blank">
                <img src="data/foto/kecamatansenapelan.png" alt="Kecamatan Senapelan">
                <h3>Website Kecamatan Senapelan</h3>
            </a>
        </div>
        
        <!-- GRID KELURAHAN -->
        <div class="grid">
            <div class="card">
                <a href="kelurahankampungbandar.html">
                    <img src="data/foto/kampungbandar.png" alt="Kampung Bandar">
                    <h3>Kelurahan Kampung Bandar</h3>
                </a>
            </div>
            
            <div class="card">
                <a href="kelurahankampungbaru.html">
                    <img src="data/foto/kampungbaru.png" alt="Kampung Baru">
                    <h3>Kelurahan Kampung Baru</h3>
                </a>
            </div>
            
            <div class="card">
                <a href="kelurahankampungdalam.html">
                    <img src="data/foto/kampungdalam.png" alt="Kampung Dalam">
                    <h3>Kelurahan Kampung Dalam</h3>
                </a>
            </div>
            
            <div class="card">
                <a href="kelurahanpadangbulan.html">
                    <img src="data/foto/padangbulan.png" alt="Padang Bulan">
                    <h3>Kelurahan Padang Bulan</h3>
                </a>
            </div>
            
            <div class="card">
                <a href="kelurahanpadangterubuk.html">
                    <img src="data/foto/padangterubuk.png" alt="Padang Terubuk">
                    <h3>Kelurahan Padang Terubuk</h3>
                </a>
            </div>
            
            <div class="card">
                <a href="kelurahansago.html">
                    <img src="data/foto/sago.png" alt="Sago">
                    <h3>Kelurahan Sago</h3>
                </a>
            </div>
        </div>
    </div>
    
    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-content">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/Logo_lambang_kota_pekanbaru.png/200px-Logo_lambang_kota_pekanbaru.png" alt="Pekanbaru" class="footer-logo">
            
            <div class="copyright">
                Â© 2026 Kecamatan Senapelan, Kota Pekanbaru
            </div>
            
            <div class="footer-links">
                <a href="https://kec-senapelan.pekanbaru.go.id/" target="_blank">Website Resmi</a>
                <a href="mailto:senapelan@pekanbaru.go.id">Email</a>
                <a href="tel:+62712345678">Telepon</a>
                <a href="https://maps.app.goo.gl/" target="_blank">Lokasi</a>
            </div>
            
            <div class="footer-note">
                Inovasi pelayanan publik berbasis digital untuk kesejahteraan masyarakat
            </div>
        </div>
    </footer>
    
    <!-- BACKGROUND MUSIC -->
    <audio id="bgMusic" loop>
        <source src="data/sound/home.mp3" type="audio/mpeg">
    </audio>

    <script>
    // =============================================
    // PWA INSTALLATION SCRIPT - SIMPLIFIED
    // =============================================
    
    // Show install banner immediately for testing
    const installBanner = document.getElementById('installBanner');
    let deferredPrompt;
    
    // Always show banner for now
    installBanner.style.display = 'block';
    
    // Listen for beforeinstallprompt event
    window.addEventListener('beforeinstallprompt', (e) => {
        console.log('beforeinstallprompt event fired');
        e.preventDefault();
        deferredPrompt = e;
        
        // Update button text
        const installBtn = document.getElementById('installBtn');
        installBtn.innerHTML = 'ðŸ“² Install Aplikasi';
        installBtn.style.display = 'block';
    });
    
    // Install button click
    document.getElementById('installBtn').addEventListener('click', async () => {
        console.log('Install button clicked');
        
        if (deferredPrompt) {
            // Show install prompt for Android/Chrome
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            console.log(`User response: ${outcome}`);
            
            if (outcome === 'accepted') {
                console.log('PWA installed successfully');
                installBanner.style.display = 'none';
                localStorage.setItem('appInstalled', 'true');
            }
            
            deferredPrompt = null;
        } else {
            // For iOS or other browsers, show instructions
            showIOSInstructions();
        }
    });
    
    // Later button
    document.getElementById('laterBtn').addEventListener('click', () => {
        installBanner.style.display = 'none';
        localStorage.setItem('bannerDismissed', 'true');
    });
    
    // Close button
    document.getElementById('closeInstall').addEventListener('click', () => {
        installBanner.style.display = 'none';
        localStorage.setItem('bannerDismissed', 'true');
    });
    
    // Show iOS instructions
    function showIOSInstructions() {
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);
        const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
        
        if (isIOS && isSafari) {
            alert('Untuk menginstall aplikasi:\n\n1. Tap tombol Share (kotak dengan panah)\n2. Scroll ke bawah\n3. Pilih "Tambahkan ke Layar Utama"\n4. Tap "Tambahkan"');
        } else {
            alert('Untuk menginstall aplikasi:\n\n1. Buka menu browser (3 titik)\n2. Pilih "Install App" atau "Add to Home Screen"\n3. Ikuti instruksi yang muncul');
        }
    }
    
    // Check if app is already installed
    function isPWAInstalled() {
        return window.matchMedia('(display-mode: standalone)').matches || 
               window.navigator.standalone === true ||
               localStorage.getItem('appInstalled') === 'true';
    }
    
    // Hide banner if app is already installed
    if (isPWAInstalled()) {
        installBanner.style.display = 'none';
    }
    
    // Check if banner was dismissed
    if (localStorage.getItem('bannerDismissed') === 'true') {
        installBanner.style.display = 'none';
    }
    
    // =============================================
    // SERVICE WORKER REGISTRATION
    // =============================================
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            // Register from root
            navigator.serviceWorker.register('/sw.js')
                .then(registration => {
                    console.log('Service Worker registered:', registration);
                })
                .catch(error => {
                    console.log('Service Worker registration failed:', error);
                    
                    // Fallback: Try without slash
                    navigator.serviceWorker.register('sw.js')
                        .then(registration => {
                            console.log('Service Worker registered (fallback):', registration);
                        })
                        .catch(err => {
                            console.log('Service Worker fallback also failed:', err);
                        });
                });
        });
    }
    
    // =============================================
    // OTHER FUNCTIONS
    // =============================================
    
    // Background music
    document.addEventListener('click', function() {
        const music = document.getElementById('bgMusic');
        music.volume = 0.3;
        music.play().catch(e => console.log('Autoplay prevented'));
    }, { once: true });
    
    // Card hover effects
    document.querySelectorAll('.card a, .card-utama a').forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-5px)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
    
    // Online/offline detection
    window.addEventListener('online', () => {
        console.log('Online');
    });
    
    window.addEventListener('offline', () => {
        console.log('Offline');
    });
    
    // Log PWA support
    console.log('PWA Support:', {
        serviceWorker: 'serviceWorker' in navigator,
        beforeInstallPrompt: 'BeforeInstallPromptEvent' in window,
        standalone: window.matchMedia('(display-mode: standalone)').matches
    });
    </script>
</body>
</html>
